# 非可換KAT表現によるリーマン予想の超高次元数値シミュレーション

## 概要

このプロジェクトは、非可換コルモゴロフ-アーノルド表現（NKAT）理論に基づき、リーマン予想の次元1000までの超高次元数値シミュレーションを実行します。RTX 3080 GPUを活用して大規模な行列計算を効率的に行い、以下の項目を検証します：

1. 超収束因子 $\mathcal{S}(N)$ の漸近挙動
2. $\theta_q$ パラメータの $\text{Re}(\theta_q) = \frac{1}{2}$ への収束性
3. リーマンゼータ関数のゼロ点とNKATエネルギー固有値の対応
4. 固有値統計のGUE（ガウス・ユニタリ・アンサンブル）分布との一致

## 必要条件

- NVIDIA RTX 3080以上のGPU
- CUDA 11.0以上
- Python 3.8以上
- PyTorch 1.9以上（CUDA対応版）
- NumPy, Matplotlib, SciPy
- mpmath

## 依存パッケージのインストール

```bash
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
pip install numpy matplotlib scipy mpmath
```

## 使用方法

1. スクリプトをダウンロードします
2. 以下のコマンドを実行します

```bash
python nkat_riemann_simulation.py
```

シミュレーションは非常に計算負荷が高く、次元1000まで完了するには数時間から数日かかることがあります。途中経過は逐次出力され、結果はグラフとテキストファイルとして`nkat_simulation_results`ディレクトリに保存されます。

## パラメータ設定

スクリプト内の以下のパラメータを調整することで、シミュレーションの挙動を変更できます：

- `MAX_DIMENSION`: シミュレーションする最大次元（デフォルト: 1000）
- `STEP_SIZE`: 次元間のステップサイズ（デフォルト: 20）
- `N_SAMPLES`: 各次元でのサンプル数（デフォルト: 100）
- `BATCH_SIZE`: GPUメモリ使用量を管理するためのバッチサイズ（デフォルト: 5）

## 理論的パラメータ

現在のシミュレーションでは、以下の理論的パラメータが使用されています：

- 超収束因子のパラメータ:
  - $\gamma = 0.23422(3)$
  - $\delta = 0.03511(2)$
  - $N_c = 17.2644(5)$（臨界次元）
- 収束速度のパラメータ:
  - $C = 0.0628(1)$
  - $D = 0.0035(1)$
  - $\alpha = 0.7422(3)$

## 出力ファイル

シミュレーション完了後、以下のファイルが生成されます：

1. `superconvergence_verification.png`: 超収束性の検証グラフ
2. `riemann_correspondence.png`: リーマンゼロ点との対応検証グラフ
3. `gue_correlation.png`: GUE統計との相関グラフ
4. `nkat_comprehensive_results.png`: 総合結果の4パネルグラフ
5. `ultrahigh_dimension_results.png`: 次元900-1000での詳細結果
6. `simulation_results.txt`: 数値データと最終結論を含むテキストファイル

## 検証ポイント

このシミュレーションは、リーマン予想の非可換KAT表現における以下の検証ポイントを評価します：

1. **超収束因子の漸近挙動**: $\mathcal{S}(N)$ の対数増大則は高次元数値計算で検証されます
2. **固有値の収束特性**: $\theta_q$ パラメータの $\text{Re}(\theta_q) = \frac{1}{2}$ への収束速度を評価します
3. **リーマンゼロ点との対応**: 固有値分布とリーマンゼータ関数のゼロ点の対応関係を検証します
4. **GUE統計との一致**: 固有値間隔分布がGUE統計と一致するかを検証します

## メモリ管理

RTX 3080は10GBのVRAMを搭載していますが、次元1000の対称行列は約8GBのメモリを必要とします。スクリプトはメモリ使用量を管理するために以下の手法を実装しています：

1. バッチ処理によるサンプル分割
2. 計算後のモデル・テンソルの明示的解放
3. `torch.cuda.empty_cache()`による定期的なGPUメモリクリア

## 注意事項

- 特に次元800以上のシミュレーションでは、GPUメモリ不足のエラーが発生する可能性があります。その場合は`BATCH_SIZE`を小さくするか、`MAX_DIMENSION`を減らしてください。
- シミュレーションが途中で停止した場合、`dimensions`パラメータを調整して途中から再開することができます。
- 長時間のシミュレーションでGPUの温度が上昇する可能性があるため、適切な冷却環境を確保してください。

## 結果の解釈

シミュレーション結果は自動的に解析され、最終的な結論がテキストファイルに記録されます。特に以下のポイントが重要です：

1. 最終次元での $|\text{Re}(\theta_q) - \frac{1}{2}|$ の値が $10^{-10}$ 未満であれば、リーマン予想を強く支持する証拠と見なされます
2. 実測偏差が理論的予測と10%以内で一致する場合、モデルの超収束性が確認されたと見なされます
3. GUE統計との相関係数が0.95を超える場合、ランダム行列理論との関連が支持されます 